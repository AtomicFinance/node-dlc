import { BitcoinNetworks } from 'bitcoin-networks';
import { expect } from 'chai';

import { ContractInfo } from '../../lib/messages/ContractInfo';
import {
  DlcOffer,
  DlcOfferV0,
  LOCKTIME_THRESHOLD,
} from '../../lib/messages/DlcOffer';
import { FundingInput } from '../../lib/messages/FundingInput';
import { MessageType } from '../../lib/MessageType';

// single_oracle_numerical_hyperbola_test
const testVector = {
  offer_message: {
    message: {
      protocolVersion: 1,
      contractFlags: 0,
      chainHash:
        '06226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f',
      temporaryContractId:
        '265523f7249ea234a34305f4b3b7120cf6a602c2e7527950c8a04f5baa8bb963',
      contractInfo: {
        singleContractInfo: {
          totalCollateral: 200000000,
          contractInfo: {
            contractDescriptor: {
              numericOutcomeContractDescriptor: {
                numDigits: 10,
                payoutFunction: {
                  payoutFunctionPieces: [
                    {
                      endPoint: {
                        eventOutcome: 0,
                        outcomePayout: 0,
                        extraPrecision: 0,
                      },
                      payoutCurvePiece: {
                        hyperbolaPayoutCurvePiece: {
                          usePositivePiece: true,
                          translateOutcome: 50.0,
                          translatePayout: 50.0,
                          a: 5.0,
                          b: -1.0,
                          c: 0.0,
                          d: 1.0,
                        },
                      },
                    },
                  ],
                  lastEndpoint: {
                    eventOutcome: 1023,
                    outcomePayout: 0,
                    extraPrecision: 0,
                  },
                },
                roundingIntervals: {
                  intervals: [
                    {
                      beginInterval: 0,
                      roundingMod: 1,
                    },
                  ],
                },
              },
            },
            oracleInfo: {
              single: {
                oracleAnnouncement: {
                  announcementSignature:
                    '71c383f82dd12c6396c2318bf4ee20957003f24af045e90686e3b61725fa3ba39627f95cb32df6cfff63707dfe6de140caaf712f07522cf4c28a1fdb0e5f7e60',
                  oraclePublicKey:
                    '5305877f0d084a5ff3a86d441d730f2ed49a355c7420b1d0d74e154828cc9c17',
                  oracleEvent: {
                    oracleNonces: [
                      '588fd77b53f92c774b6eee247c0bb19c9b4fbe97623b9ff23047c43c267bd938',
                      '9358405f95fdd4f4115c67ef5842d9b2ea9c149fe35f59f9f43e59ebc8b87aac',
                      'fe2062dae073de49b739e84472c5b182af521b39c4c5a0211df2d27505c93912',
                      '51e69daf13968bd3284b96ef26c7890970a027c50db8b6e080b970d9c2bec7a5',
                      '30342d771ccf499b097405fd844fae11f987d46844ff41d7373052db116fdce1',
                      '4ccf20cf44164673211db1b3c015ebc751159b9f5267270bfc71eda6bd2fe11e',
                      '6c5e561c8e55219e6fd542d2df7b8ce607e08f8ae2f3409e914742668b8b6409',
                      'bf9170c2c62f54ca66b39650f0d0f7ca68e226384d3a1ec7551bfe1cc7974438',
                      'fc1207ebcf60f7380d7922795a8daf7d21af3ead57001dc91c7bbe65827ba2e1',
                      'a51a9ecc64daeefb834823057eeaacbecfff81086582e43bedf7900a9595407b',
                    ],
                    eventMaturityEpoch: 1623133104,
                    eventDescriptor: {
                      digitDecompositionEvent: {
                        base: 2,
                        isSigned: false,
                        unit: 'sats/sec',
                        precision: 0,
                        nbDigits: 10,
                      },
                    },
                    eventId: 'Test',
                  },
                },
              },
            },
          },
        },
      },
      fundingPubkey:
        '032ec14eb5e7daf454c4515590d5fc8331fc5459111504b13335c73135b2212add',
      payoutSpk: '001453f0995f34cc1a554884a9d5e6e6853ac8e6d73f',
      payoutSerialId: 1397437509772838018,
      offerCollateral: 100000000,
      fundingInputs: [
        {
          inputSerialId: 9283287567477086542,
          prevTx:
            '020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a01000000160014d6c08add373e1e9a518d5a95b5ffb27e002e1c370000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000',
          prevTxVout: 0,
          sequence: 4294967295,
          maxWitnessLen: 107,
          redeemScript: '',
        },
      ],
      changeSpk: '0014b1bf5709f5ab90f87771a5b4b763243aa375cdaa',
      changeSerialId: 12065621157061494665,
      fundOutputSerialId: 17610968839659761095,
      feeRatePerVb: 2,
      cetLocktime: 1623133104,
      refundLocktime: 1623737904,
    },
    serialized:
      'a71a000000010006226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f265523f7249ea234a34305f4b3b7120cf6a602c2e7527950c8a04f5baa8bb96300000000000bebc20001000a01000000000000000000000000000000000000010101000000000000003200000100000000000000320000010000000000000005000000000000000000000100000100000000000000000000010000000000000001000000000000000003ff00000000000000000000010000000000000000000000000000000100fdd824fd01c771c383f82dd12c6396c2318bf4ee20957003f24af045e90686e3b61725fa3ba39627f95cb32df6cfff63707dfe6de140caaf712f07522cf4c28a1fdb0e5f7e605305877f0d084a5ff3a86d441d730f2ed49a355c7420b1d0d74e154828cc9c17fdd822fd0161000a588fd77b53f92c774b6eee247c0bb19c9b4fbe97623b9ff23047c43c267bd9389358405f95fdd4f4115c67ef5842d9b2ea9c149fe35f59f9f43e59ebc8b87aacfe2062dae073de49b739e84472c5b182af521b39c4c5a0211df2d27505c9391251e69daf13968bd3284b96ef26c7890970a027c50db8b6e080b970d9c2bec7a530342d771ccf499b097405fd844fae11f987d46844ff41d7373052db116fdce14ccf20cf44164673211db1b3c015ebc751159b9f5267270bfc71eda6bd2fe11e6c5e561c8e55219e6fd542d2df7b8ce607e08f8ae2f3409e914742668b8b6409bf9170c2c62f54ca66b39650f0d0f7ca68e226384d3a1ec7551bfe1cc7974438fc1207ebcf60f7380d7922795a8daf7d21af3ead57001dc91c7bbe65827ba2e1a51a9ecc64daeefb834823057eeaacbecfff81086582e43bedf7900a9595407b60bf0bb0fdd80a1200020008736174732f73656300000000000a0454657374032ec14eb5e7daf454c4515590d5fc8331fc5459111504b13335c73135b2212add0016001453f0995f34cc1a554884a9d5e6e6853ac8e6d73f1364b202ddd104820000000005f5e1000180d4dcdb8f45994ea8020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a01000000160014d6c08add373e1e9a518d5a95b5ffb27e002e1c370000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf9012000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff006b000000160014b1bf5709f5ab90f87771a5b4b763243aa375cdaaa771b28415168789f466bada4e64adc7000000000000000260bf0bb060c84630',
  },
};

// enum_single_oracle_test
const testVector2 = {
  offer_message: {
    message: {
      protocolVersion: 1,
      contractFlags: 0,
      chainHash:
        '06226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f',
      temporaryContractId:
        '50a38b0f6bc6627a330f93ef62b1685e45d390f0c2e008784a494ae3f77e0475',
      contractInfo: {
        singleContractInfo: {
          totalCollateral: 200000000,
          contractInfo: {
            contractDescriptor: {
              enumeratedContractDescriptor: {
                payouts: [
                  {
                    outcome: 'a',
                    localPayout: 200000000,
                  },
                  {
                    outcome: 'b',
                    localPayout: 0,
                  },
                  {
                    outcome: 'c',
                    localPayout: 200000000,
                  },
                  {
                    outcome: 'd',
                    localPayout: 0,
                  },
                ],
              },
            },
            oracleInfo: {
              single: {
                oracleAnnouncement: {
                  announcementSignature:
                    '288a4ac72f3f627ceecf61753f94c437f9e761950ce1dd4ad787cdf6f525ce11b6cea81689ad41511d4366db5fb591b40864f59c4e9e0cf2c7dac89224d98c55',
                  oraclePublicKey:
                    '3d563caec479d618bad3cb0e844f57dcd977f23e5d6d84e1e3be51bb33133cb0',
                  oracleEvent: {
                    oracleNonces: [
                      '5c1785f8ab4273d56ac67d4b0429c40107cec5875246a2b68872792c2096e3a7',
                    ],
                    eventMaturityEpoch: 1623133104,
                    eventDescriptor: {
                      enumEvent: {
                        outcomes: ['a', 'b', 'c', 'd'],
                      },
                    },
                    eventId: 'Test',
                  },
                },
              },
            },
          },
        },
      },
      fundingPubkey:
        '0284014ca41f49f56553b01d7da4f6c19afed76ac5d2fecde0bab6a878b57092ed',
      payoutSpk: '00148ac3370f8bb5840112756ec4a48d4f417c958b68',
      payoutSerialId: 4891480442309882974,
      offerCollateral: 100000000,
      fundingInputs: [
        {
          inputSerialId: 5330895180221467292,
          prevTx:
            '020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a01000000160014dbd4ce44e8f4db05f35ca1c16378c56017b0582b0000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000',
          prevTxVout: 0,
          sequence: 4294967295,
          maxWitnessLen: 107,
          redeemScript: '',
        },
      ],
      changeSpk: '0014b742726c4817779988527052274d2a6f95c2cfb1',
      changeSerialId: 15716098011649384884,
      fundOutputSerialId: 9046284180399923145,
      feeRatePerVb: 2,
      cetLocktime: 1623133104,
      refundLocktime: 1623737904,
    },
    serialized:
      'a71a000000010006226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f50a38b0f6bc6627a330f93ef62b1685e45d390f0c2e008784a494ae3f77e047500000000000bebc20000040161000000000bebc200016200000000000000000163000000000bebc2000164000000000000000000fdd8249d288a4ac72f3f627ceecf61753f94c437f9e761950ce1dd4ad787cdf6f525ce11b6cea81689ad41511d4366db5fb591b40864f59c4e9e0cf2c7dac89224d98c553d563caec479d618bad3cb0e844f57dcd977f23e5d6d84e1e3be51bb33133cb0fdd8223900015c1785f8ab4273d56ac67d4b0429c40107cec5875246a2b68872792c2096e3a760bf0bb0fdd8060a0004016101620163016404546573740284014ca41f49f56553b01d7da4f6c19afed76ac5d2fecde0bab6a878b57092ed001600148ac3370f8bb5840112756ec4a48d4f417c958b6843e2078bcda6b45e0000000005f5e1000149fb24ec0ff14a9ca8020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a01000000160014dbd4ce44e8f4db05f35ca1c16378c56017b0582b0000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf9012000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff006b000000160014b742726c4817779988527052274d2a6f95c2cfb1da1acbdfc795a1b47d8adb8865f91fc9000000000000000260bf0bb060c84630',
  },
  accept_message: {
    message: {
      protocolVersion: 1,
      temporaryContractId:
        '50a38b0f6bc6627a330f93ef62b1685e45d390f0c2e008784a494ae3f77e0475',
      acceptCollateral: 100000000,
      fundingPubkey:
        '02ccce3c8cbe1967575f842c2e2cec30544e538b2bbbf70c1d8addd9cc7a88d313',
      payoutSpk: '00147e55961083dcce1e327fbb196a8c5018212ff271',
      payoutSerialId: 11737905950571233819,
      fundingInputs: [
        {
          inputSerialId: 4569206667490474259,
          prevTx:
            '020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03510101ffffffff0200f2052a0100000016001443ee3f9efb953a807a2b6b2ade822ed00e97620b0000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000',
          prevTxVout: 0,
          sequence: 4294967295,
          maxWitnessLen: 107,
          redeemScript: '',
        },
      ],
      changeSpk: '0014c7fdaa6779e2c5845d6f5034c4830cedf3b3fb17',
      changeSerialId: 13981087499650180058,
      cetAdaptorSignatures: {
        ecdsaAdaptorSignatures: [
          {
            signature:
              '03a6413efb4b1c27f42230c16fca661e32cfd7da73695abbcfc6d1f300c97255a702ccf9d57a60f445d00ca6f640ba5aa1561faaf4c8542a92dce60fa11ffe3726de8087673c9ca83320b28c974819089e599794cd4a5c9702c0fc77fff62db208ceec6e09492e20a3e6a6b58e3bdd5dcb279b151b13c8bc33c178c210054ad9aa522c98f3ccbdbbbc1a4226214aa5a03db358e0331f64731a7ea2a7bf5785596d3d',
          },
          {
            signature:
              '03303735fb8d39465519ce0d474a298ef9b9561401c5c69c182a053b032eebda3e021bf934cd86039649169ee8a55a6796fa7a8a5f53ddfb12ae9586dbfee133221aa8bbe19cd239babbd1cb1554a39f3751aaa1f0848fcb0e9ef559403db443f4adca06e22dfc88e5100e742775ce6c43e563ef80f882b5307018f704ec85ea46c8b07f19f5990fbb3dbd8a4406480d7961e067e4789a54f4f25ef78c01c6f0b372',
          },
          {
            signature:
              '0391e9c21152564e49dcdc32e574f4b39822d9f959ed24111735355cb6916be2e50271533f1d9314b2bc04cbc511c69378d704e376df8fbdd5ebf8b17814475d0004ea6b9ee32f3939816222e887b90f2233f88a9ea313564e34c075a170b7b28a78e7d2976419e74a8a44763c1a14652d436b79a26af0a3105e7bcbd7e0839e1cf2841fa9914a880906be18432bfc5e886d19e72e9027171d67f384d703f2bb6535',
          },
          {
            signature:
              '03dd02a7b411a3e7f5a511baf880b8d75a68f8b861aac6815617282cd73a2ea6b102a353d67381ab4cb233ee6596c3f3e17bca06070aea52927b9571835968b1ac42633976c3466bdfc07244080d4e4061a9d794e14c432cae021ebd433b9ea00b788a4d0ec1a4c30443560afa2fcd75815472d082141d27b087a13bb85e33a17af9753dac8a626bbe648fd6e6ce06000d0b93f081af3b6469d8ecb2161a998ae445',
          },
        ],
      },
      refundSignature:
        '304402203a6439522713098d312856a32de541692ea73c5eb5308e29d6e2387a3bc7f7960220672fa4b5cd0f347c7b8ede876c275412402ed42781137bb195fe7da04b0f3abf',
      negotiationFields: null,
    },
    serialized:
      'a71c0000000150a38b0f6bc6627a330f93ef62b1685e45d390f0c2e008784a494ae3f77e04750000000005f5e10002ccce3c8cbe1967575f842c2e2cec30544e538b2bbbf70c1d8addd9cc7a88d313001600147e55961083dcce1e327fbb196a8c5018212ff271a2e56b459ebe021b013f691541611db913a8020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03510101ffffffff0200f2052a0100000016001443ee3f9efb953a807a2b6b2ade822ed00e97620b0000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf9012000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff006b000000160014c7fdaa6779e2c5845d6f5034c4830cedf3b3fb17c206cd01864da3da0403a6413efb4b1c27f42230c16fca661e32cfd7da73695abbcfc6d1f300c97255a702ccf9d57a60f445d00ca6f640ba5aa1561faaf4c8542a92dce60fa11ffe3726de8087673c9ca83320b28c974819089e599794cd4a5c9702c0fc77fff62db208ceec6e09492e20a3e6a6b58e3bdd5dcb279b151b13c8bc33c178c210054ad9aa522c98f3ccbdbbbc1a4226214aa5a03db358e0331f64731a7ea2a7bf5785596d3d03303735fb8d39465519ce0d474a298ef9b9561401c5c69c182a053b032eebda3e021bf934cd86039649169ee8a55a6796fa7a8a5f53ddfb12ae9586dbfee133221aa8bbe19cd239babbd1cb1554a39f3751aaa1f0848fcb0e9ef559403db443f4adca06e22dfc88e5100e742775ce6c43e563ef80f882b5307018f704ec85ea46c8b07f19f5990fbb3dbd8a4406480d7961e067e4789a54f4f25ef78c01c6f0b3720391e9c21152564e49dcdc32e574f4b39822d9f959ed24111735355cb6916be2e50271533f1d9314b2bc04cbc511c69378d704e376df8fbdd5ebf8b17814475d0004ea6b9ee32f3939816222e887b90f2233f88a9ea313564e34c075a170b7b28a78e7d2976419e74a8a44763c1a14652d436b79a26af0a3105e7bcbd7e0839e1cf2841fa9914a880906be18432bfc5e886d19e72e9027171d67f384d703f2bb653503dd02a7b411a3e7f5a511baf880b8d75a68f8b861aac6815617282cd73a2ea6b102a353d67381ab4cb233ee6596c3f3e17bca06070aea52927b9571835968b1ac42633976c3466bdfc07244080d4e4061a9d794e14c432cae021ebd433b9ea00b788a4d0ec1a4c30443560afa2fcd75815472d082141d27b087a13bb85e33a17af9753dac8a626bbe648fd6e6ce06000d0b93f081af3b6469d8ecb2161a998ae4453a6439522713098d312856a32de541692ea73c5eb5308e29d6e2387a3bc7f796672fa4b5cd0f347c7b8ede876c275412402ed42781137bb195fe7da04b0f3abf00',
  },
  sign_message: {
    message: {
      protocolVersion: 1,
      contractId:
        'c4b20c1093c2a0e9abf1292339b4c74a46a8c086e7b0020229f58469257f3b27',
      cetAdaptorSignatures: {
        ecdsaAdaptorSignatures: [
          {
            signature:
              '03cc5007225e2faba8558693e7114528d336b88e4eef545fe50eb1cc802c163863034b900a603964017e3c5f1e7042c19b806f143ac23099a28944b9296163379b9f18a9579128b0bac67d7cdc33b11660a282c47e58419ddf83f1820d9e9093b77e0be83c99e041f8c76bbfc88adc3b21bd77649854b794c702fc507dd3ba6981bdb2f080598af23b7a2d0282f174838848c4924bcc800521a2486ab699900124d1',
          },
          {
            signature:
              '0321552df9fe5dc1ddafc0f570470013ffeae11da4d2b3d46d8af64dc398b637de02ebe8d05cde0786f7493b36903fbc3973cee897b5b52795550021c3cf536d7770d8c25016716f7b320718e70e637f422417d231be34ffcfca6acfa408f6d46d58b105156c3bdec9d03926eb3a6153760dd2826b330654228a8430f7c447872e006efc633bd0070e6b5abe583f6c6e01a7c8588b6918bbd7217764e1bfd12ecb53',
          },
          {
            signature:
              '02ce8463621bfadd4cd23f814621c6d50f1ab7bb7e4089b0b4c2b4da89187150a0023728622f07e9c54f957a9581f81b6f55ed4b2f8e8d792fb90ce5b4a56e91b10c96c3005e43a689733b4d0efabc0040c9e625677e8913b978c39ff494159382c91087629f0a7a6a38893d8861f55bdc777536e2569852d1f3adfe204cc542790611c4d0686752dd6f4fdcce504d981a91ac610365d2ae8508ed14a8667b7de923',
          },
          {
            signature:
              '03edb6aa6b1372676377e3188fc5aa9178e57e5fff54283b637c3231685eb4d0680368d5ab2fa22a76aa64d8402391cc8d75d6d149f9c8968c3982b20baedbd79aa644541bd8bb9885be99a7890dd882608f628dab6c1bb0e27d23ddb672db3523194839313be2efa73d945c87ee54bc41cda58c0520b7fb9493113660bfaeb5e37b15626265fd54499a81574800970980cb2b55e596e8395c8c4fdeac1c265e1124',
          },
        ],
      },
      refundSignature:
        '3044022066d4efff70aabf694350e9edcb2028a6fe2e800b1e2383cbbf60e54a987164a502202374952071694c79cc1a86351e8f184fb678b344eb2a9daa2eefcac850b2f4aa',
      fundingSignatures: {
        fundingSignatures: [
          {
            witnessElements: [
              {
                witness:
                  '3044022006879b1f367adf6ed2d727c9a27660ece53a8cb6ab1cff48d1d573815fdd5e65022049ae6c3a3c62196a26276afd06e2af251790d13015beb188d2c0a4f6cdaac5dc01',
              },
              {
                witness:
                  '027b48d902e88b706d54f4518395db235c83f1adba64c6c1d290cb1369c09abeb2',
              },
            ],
          },
        ],
      },
    },
    serialized:
      'a71e00000001c4b20c1093c2a0e9abf1292339b4c74a46a8c086e7b0020229f58469257f3b270403cc5007225e2faba8558693e7114528d336b88e4eef545fe50eb1cc802c163863034b900a603964017e3c5f1e7042c19b806f143ac23099a28944b9296163379b9f18a9579128b0bac67d7cdc33b11660a282c47e58419ddf83f1820d9e9093b77e0be83c99e041f8c76bbfc88adc3b21bd77649854b794c702fc507dd3ba6981bdb2f080598af23b7a2d0282f174838848c4924bcc800521a2486ab699900124d10321552df9fe5dc1ddafc0f570470013ffeae11da4d2b3d46d8af64dc398b637de02ebe8d05cde0786f7493b36903fbc3973cee897b5b52795550021c3cf536d7770d8c25016716f7b320718e70e637f422417d231be34ffcfca6acfa408f6d46d58b105156c3bdec9d03926eb3a6153760dd2826b330654228a8430f7c447872e006efc633bd0070e6b5abe583f6c6e01a7c8588b6918bbd7217764e1bfd12ecb5302ce8463621bfadd4cd23f814621c6d50f1ab7bb7e4089b0b4c2b4da89187150a0023728622f07e9c54f957a9581f81b6f55ed4b2f8e8d792fb90ce5b4a56e91b10c96c3005e43a689733b4d0efabc0040c9e625677e8913b978c39ff494159382c91087629f0a7a6a38893d8861f55bdc777536e2569852d1f3adfe204cc542790611c4d0686752dd6f4fdcce504d981a91ac610365d2ae8508ed14a8667b7de92303edb6aa6b1372676377e3188fc5aa9178e57e5fff54283b637c3231685eb4d0680368d5ab2fa22a76aa64d8402391cc8d75d6d149f9c8968c3982b20baedbd79aa644541bd8bb9885be99a7890dd882608f628dab6c1bb0e27d23ddb672db3523194839313be2efa73d945c87ee54bc41cda58c0520b7fb9493113660bfaeb5e37b15626265fd54499a81574800970980cb2b55e596e8395c8c4fdeac1c265e112466d4efff70aabf694350e9edcb2028a6fe2e800b1e2383cbbf60e54a987164a52374952071694c79cc1a86351e8f184fb678b344eb2a9daa2eefcac850b2f4aa0102473044022006879b1f367adf6ed2d727c9a27660ece53a8cb6ab1cff48d1d573815fdd5e65022049ae6c3a3c62196a26276afd06e2af251790d13015beb188d2c0a4f6cdaac5dc0121027b48d902e88b706d54f4518395db235c83f1adba64c6c1d290cb1369c09abeb2',
  },
};

// single_oracle_numerical_test
const testVector3 = {
  offer_message: {
    message: {
      protocolVersion: 1,
      contractFlags: 0,
      chainHash:
        '06226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f',
      temporaryContractId:
        'a8118a81de97fd9f4a76cf51711eae9e75e4972e570c9a1519d244c0ba9b8ad4',
      contractInfo: {
        singleContractInfo: {
          totalCollateral: 200000000,
          contractInfo: {
            contractDescriptor: {
              numericOutcomeContractDescriptor: {
                numDigits: 10,
                payoutFunction: {
                  payoutFunctionPieces: [
                    {
                      endPoint: {
                        eventOutcome: 0,
                        outcomePayout: 0,
                        extraPrecision: 0,
                      },
                      payoutCurvePiece: {
                        polynomialPayoutCurvePiece: {
                          payoutPoints: [
                            {
                              eventOutcome: 3,
                              outcomePayout: 100000000,
                              extraPrecision: 0,
                            },
                          ],
                        },
                      },
                    },
                    {
                      endPoint: {
                        eventOutcome: 5,
                        outcomePayout: 200000000,
                        extraPrecision: 0,
                      },
                      payoutCurvePiece: {
                        polynomialPayoutCurvePiece: {
                          payoutPoints: [],
                        },
                      },
                    },
                  ],
                  lastEndpoint: {
                    eventOutcome: 1023,
                    outcomePayout: 200000000,
                    extraPrecision: 0,
                  },
                },
                roundingIntervals: {
                  intervals: [
                    {
                      beginInterval: 0,
                      roundingMod: 1,
                    },
                  ],
                },
              },
            },
            oracleInfo: {
              single: {
                oracleAnnouncement: {
                  announcementSignature:
                    '18b885b1c1b54d49576e4f30add39abc314174a9b78f6c426a64442ae27f6a92afc369b5f6586d00ffeb97f30877fe839aaf3c18f32328756e86f8bb5cb9f699',
                  oraclePublicKey:
                    '99a55788eb7aab8581ab2b3326d3742abaf8eb33e0a403cab0e2608e69278059',
                  oracleEvent: {
                    oracleNonces: [
                      'e586f68e10c61b454dff7d98852bb14ebb394ddd1533cab4ff4ce2a95984dc5e',
                      'e9a5b90a8f2e8665033ddda9ecb07a8e75d2b1bac6042e76e4cded3aefd3a6a6',
                      '7247bbc4b736f27e31d007f72673436764ae7e473b01cb9ef68d986ddea551b3',
                      '27ed11cc173d74b9034d2eb0b9b6ad8d62ab9d83d78ecac932aca52754a78430',
                      '40c2e9bca426284266dce339a13da4d670d849fae5d0bb8f712352fccdb21b88',
                      'f3ed61af795857818ae019ef0199cedb51dace78a078086670b2e367c5e9483d',
                      'f87b4ee8b2ba573dcea6347dc5507ca0ebb389d67b8893e99b51d14ddbcb130d',
                      '261900567c50944848b60a6b1f01c26834b19acf11610d7a897f0e204286960f',
                      '35290e37262481c04a34a0c87042f72cef8041ef4b00f928077e4f16410a9f16',
                      '31b3428792c9d5b6175328de6052c6a4eff382a890989e2498a7555d45f723e3',
                    ],
                    eventMaturityEpoch: 1623133104,
                    eventDescriptor: {
                      digitDecompositionEvent: {
                        base: 2,
                        isSigned: false,
                        unit: 'sats/sec',
                        precision: 0,
                        nbDigits: 10,
                      },
                    },
                    eventId: 'Test',
                  },
                },
              },
            },
          },
        },
      },
      fundingPubkey:
        '02e99f641141cb01fb77530d7568bacba56e88364f4b19e5d88ed3067fef16bf9f',
      payoutSpk: '001474acfd05914e2fe6ef3590e66b924c1b8e5b5202',
      payoutSerialId: 17180126627603925258,
      offerCollateral: 100000000,
      fundingInputs: [
        {
          inputSerialId: 5704075368474682491,
          prevTx:
            '020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a010000001600141cf8d1c694c1ef85e9b1294227031ce495374ab70000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000',
          prevTxVout: 0,
          sequence: 4294967295,
          maxWitnessLen: 107,
          redeemScript: '',
        },
      ],
      changeSpk: '00143d007d2c5d2b75f3f0b0c25c618438203cb74380',
      changeSerialId: 1655981339176753252,
      fundOutputSerialId: 12270250236771930173,
      feeRatePerVb: 2,
      cetLocktime: 1623133104,
      refundLocktime: 1623737904,
    },
    serialized:
      'a71a000000010006226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910fa8118a81de97fd9f4a76cf51711eae9e75e4972e570c9a1519d244c0ba9b8ad400000000000bebc20001000a02000000000000000000000000000000000000000100000000000000030000000005f5e10000000000000000000005000000000bebc2000000000000000000000003ff000000000bebc2000000010000000000000000000000000000000100fdd824fd01c718b885b1c1b54d49576e4f30add39abc314174a9b78f6c426a64442ae27f6a92afc369b5f6586d00ffeb97f30877fe839aaf3c18f32328756e86f8bb5cb9f69999a55788eb7aab8581ab2b3326d3742abaf8eb33e0a403cab0e2608e69278059fdd822fd0161000ae586f68e10c61b454dff7d98852bb14ebb394ddd1533cab4ff4ce2a95984dc5ee9a5b90a8f2e8665033ddda9ecb07a8e75d2b1bac6042e76e4cded3aefd3a6a67247bbc4b736f27e31d007f72673436764ae7e473b01cb9ef68d986ddea551b327ed11cc173d74b9034d2eb0b9b6ad8d62ab9d83d78ecac932aca52754a7843040c2e9bca426284266dce339a13da4d670d849fae5d0bb8f712352fccdb21b88f3ed61af795857818ae019ef0199cedb51dace78a078086670b2e367c5e9483df87b4ee8b2ba573dcea6347dc5507ca0ebb389d67b8893e99b51d14ddbcb130d261900567c50944848b60a6b1f01c26834b19acf11610d7a897f0e204286960f35290e37262481c04a34a0c87042f72cef8041ef4b00f928077e4f16410a9f1631b3428792c9d5b6175328de6052c6a4eff382a890989e2498a7555d45f723e360bf0bb0fdd80a1200020008736174732f73656300000000000a045465737402e99f641141cb01fb77530d7568bacba56e88364f4b19e5d88ed3067fef16bf9f0016001474acfd05914e2fe6ef3590e66b924c1b8e5b5202ee6c1224c28fc90a0000000005f5e100014f28f2537dfd247ba8020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a010000001600141cf8d1c694c1ef85e9b1294227031ce495374ab70000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf9012000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff006b0000001600143d007d2c5d2b75f3f0b0c25c618438203cb7438016fb3a41144e5864aa48af946bf1903d000000000000000260bf0bb060c84630',
  },
  accept_message: {
    message: {
      protocolVersion: 1,
      temporaryContractId:
        'a8118a81de97fd9f4a76cf51711eae9e75e4972e570c9a1519d244c0ba9b8ad4',
      acceptCollateral: 100000000,
      fundingPubkey:
        '0369b9c46c11fff6f85cc70654ac3bfd40db0ce3eae110efcf611e1494c02b53b0',
      payoutSpk: '0014b8ba9e2a6918639b7f45fd4b87cef07107d757fd',
      payoutSerialId: 13297424615021306944,
      fundingInputs: [
        {
          inputSerialId: 9093369756030533769,
          prevTx:
            '020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03510101ffffffff0200f2052a010000001600149eabd4cf35ffcc89a4119548dfb03145bf3fc2860000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000',
          prevTxVout: 0,
          sequence: 4294967295,
          maxWitnessLen: 107,
          redeemScript: '',
        },
      ],
      changeSpk: '0014485f71327d44d33dc180c849820920036d58eef2',
      changeSerialId: 9770604252826726620,
      cetAdaptorSignatures: {
        ecdsaAdaptorSignatures: [
          {
            signature:
              '022ec9f037398b4fa4f53766cccb7b6e574d17a8ddf22278568a594a2455c629cf0343f44ebb9bc6b6b57d1127366fc921d74ff04e7f0d71719c4044b50f8d1ff4473e627b1e84bef7cdf5c24da7d0c80cc378de5cac1a0eeb5f35bc62c6dea8d58042383abeaa3ff0ac21e18a4507a4a199d73519b93706c949d13c08036df26634bb6ed3f566d21193fd14c6496c0231b6387ece329d79cb27212b2214a07e9263',
          },
          {
            signature:
              '037f84dc60980180c86c954d55c086e55607e5218494fe4a4701fcf6e7ced2bdb203879ddb5f9d5e69eac99726d737125124da38f99059c0cfae7df7828d84dfa7c3272af0b007aaef5c9c350cc66aaf340c7bbba5fa858ecdf05a2a05ab4dea247e12b96dccc8b03cf7d3c4135fcafeb37dfad0de5a02aff707dc7374c9f5fb874c9fa6b6ed779e11aa8e14418007ba89a51ac02d9e01193ea77126114b5f121c8a',
          },
          {
            signature:
              '02ebaeb413d760733998ab3c8dbbd6d339330f743e9c858052aad17ad85ce89a69024435455678486a1bd8cd54513c4298187175568ddd1b23b3d87a23f8f1f80dae21a0d2e5325b99f61182659c1d817bd70e15a72d1d663da5e9e88b049d43103e755ffe26aed753c08fdf881651f674045e7c3003a90ac56c7463b20e2ac6f95b8f5c916831a27fa63a49ee857f6860532b440046ba64c6efff6bff483b640d34',
          },
          {
            signature:
              '02e55f5cae14f595f9e41419b6a07e6291e0e3de8324a45fdfd4123e22028f3a410381ddb31ffa4ab67abb253303ea3a659ea8d0c9b5f2ce767cb5974939a40142ef4f65d6df2fbfe4d6c21df4815af1f2241f33aebe14fb2b15b609594a136e9acf76f02515de62ac50ec3f850bbf25d57a6855e6cb3ba62e75cc9751807b9dd86bad851f5e203009f3792d98bda731e2f6c37e33ff5fdaa498b86be83e45656a09',
          },
          {
            signature:
              '03fdbcab72c219823c4e031afcc9ccc573c34161d3d715a363f56088e1bbc5782503fd63460cefd4b22ba702f81bbb2524cba192c9fd56104716bbab6b1dd65c6c9de03c9260728998819396204d4a6b2e4d8d5ef35662e18576128b1c3c2faa083b13b96a29f201f6ec0ca77cef569d4c31e4a99e6b90984329483fbadd46debc1fb12c9fc4bf4981f29ae883d3c079ca189a7c5893e3f384bb09ea4e834b716697',
          },
          {
            signature:
              '03cb5f5ab525a85e4493ac6959d7a4b93c9b600a5da2f3330fde02fb6a7ec6269702f1dce3f9b02b24925d34523f3340568db444a75159e9e7625fde0433166d10b17e4240c2f78fc07af30cb9ba422affaf1ef5acd16d9b8df67e8d491808fc56565a540b4d3abd116f629fcf8472d7e06018980a3cb9ce1358ab83b80a474c4c91f080845ceff55d6ceefaa26e03813586e3f22506ddc7468f1768d61077070a99',
          },
          {
            signature:
              '02783fe97e5a9edeff792a7bfe25c72d7b3093d33b1bcf974b79ecbfcf94fea4aa0262924d34ff7902cf3d6c79e03ff5099618a9158b4add1dcb7c0ee65ae916009b61d308efe3ec7080030916e3daf2b0687619bdebcccd79ac90e78bb6010ac7a6d759eb6c687a2d9025dff9c8acd1fdebb22b0ee94fe964c1bfd1f5e7b5f17097737366c37592055bd21a4c39c23439bd54bbf186dbd8b80b433fa6908b2a4be2',
          },
          {
            signature:
              '03ef486c53c6e51861d761bd762f9099ff1c9c1e9c6e51f21c5da5ff6b8278548d024a7f190a5e9b9ad5b00046de9e657d2327313c479ce6b6122884316e4b2bf7666aa2cf593c97c6d65b527ecaf0e05b04a8a3a1f1ab49c21480f0c18338e034ba72b832df12fd9fa400ca3430e72b45e41a592fc648487bd65281483396993db40cebddc33a0c5827a9aabec471b9a75cdfd1dfcfe22431baeb8133dbebf7d068',
          },
          {
            signature:
              '026ce1c81504de921e7eb699c91517bc20343ca2090ca8ec6a808ced1482a39353039d0debd33204771ea2bb8edf157073f9e205811dd1743e641124e92a8fced56023fdb4da79e114fba84350b53fdfd1f4975054b1dcdfb92b82770d8d2c009d1cf4040824b5872e5f225e6577059deb28363996a161ed6e1b02c46da08d93fa1c780235bdf84b0ae86ac1dc6a38801f39685c48336180791d0290c41ec8222688',
          },
          {
            signature:
              '02d4872c9266151037206e184c8cd4efc06fe6b0d09177f682c6f0f6f861b6067a02ce650bfa1e6ea09433a6aa2e61ee13d0797551e05ffef5fc09a90ccb6ed2d4654f4628f5807eb5de39bb84538155cf7f22df14530141a061401b6eeae7d2a2119d640d3237ceb49d1b255434180e0cca9a27e4258ff0b1ccc04996ec2c3141a8b5d08f4bf874a36d269bf3e5d8aef7436c26079c8c8374d1cd5de7594409b9db',
          },
          {
            signature:
              '02930223043f3090216873b269ee88ffa8e45628368a449beff248a51a32d5f007035f09f1fa2815d511f115866a645393c05f58e68bbbd9a05bec4caae12827a8bebd75b98bf017813a9d05e08076fcfa7b261a8dc7d422dc6d0fea333145965809ad7ab5e9aa4f99c988d7400f6c6d45d2dc982925546c8d6ce9e828e2b7f312a6293bb3a47304995873f2b49e2d0cd24d9a9c718c00a09f60e9f45e9029a3eec8',
          },
          {
            signature:
              '0273a5c13e0806b14b9d028f8ef827734af03560811c97a56e582651f75b78f89902a86bd986b166d57a6d3935ea3bb0f44256a679e9bc777adac11635d8e5bad9e0d3257b945e245492c28c4714d51fa0aad63cc60c8a683bf776e7aba4505322cd3969a021c4db2156239b606ffe3a1698b198c7fa2a3e9262cd8427673a156ecb1c09febb906ae41517e54dc8a350b03b2d75c49508acee9225cfd83da4620904',
          },
          {
            signature:
              '03b8148470b1af8414cc50da5a0738749a0e63f45936416497870b9a66fb85fa480370e7acb6720e4bfac5d9c292b4bba40e6ee563ad349bb75bf447c1a251f7e7b5afa487f34d78954adef4c82c47cc3643b6a9e4c11e183ca5e7d981832096b6a3896c4d6cf54360603cc230a0a7949e6a2bf9891dd434d7124d15c99999e3ef7a75de1ee5f685dcdb4f5ecfd41897da7e5c3b0e46fd702d231a806e50a81da72a',
          },
          {
            signature:
              '03267cd555e70b7683fbecd8ce077998af44f39429feceb7536fd63c5c1cc462270351161d492e7a9dec960f006219aaf26e292ec9401ee374b8199604cca68b769742df3f2691e4f6825e9423f3479f06639033826e94ad4a276566a3599052b0ed095f906386bb725a20aaf2904e6bdff7d5aae99ee8575860288e267d2fb6d21ba7e41116d50d0845adbc21da57903399e81ef52d03871fbc3a264ca0bc451560',
          },
        ],
      },
      refundSignature:
        '3044022063732e3c4166bddd92860e0a53e2b44cc8a084f0f67af918998a8d006cbbb930022038fe6e489d755d9a1b855d92570a1da83410d66f9d693ea098dfb198f00030f5',
      negotiationFields: null,
    },
    serialized:
      'a71c00000001a8118a81de97fd9f4a76cf51711eae9e75e4972e570c9a1519d244c0ba9b8ad40000000005f5e1000369b9c46c11fff6f85cc70654ac3bfd40db0ce3eae110efcf611e1494c02b53b000160014b8ba9e2a6918639b7f45fd4b87cef07107d757fdb889f13c0de16440017e32239d477b0089a8020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03510101ffffffff0200f2052a010000001600149eabd4cf35ffcc89a4119548dfb03145bf3fc2860000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf9012000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff006b000000160014485f71327d44d33dc180c849820920036d58eef2879828cd12a870dc0e022ec9f037398b4fa4f53766cccb7b6e574d17a8ddf22278568a594a2455c629cf0343f44ebb9bc6b6b57d1127366fc921d74ff04e7f0d71719c4044b50f8d1ff4473e627b1e84bef7cdf5c24da7d0c80cc378de5cac1a0eeb5f35bc62c6dea8d58042383abeaa3ff0ac21e18a4507a4a199d73519b93706c949d13c08036df26634bb6ed3f566d21193fd14c6496c0231b6387ece329d79cb27212b2214a07e9263037f84dc60980180c86c954d55c086e55607e5218494fe4a4701fcf6e7ced2bdb203879ddb5f9d5e69eac99726d737125124da38f99059c0cfae7df7828d84dfa7c3272af0b007aaef5c9c350cc66aaf340c7bbba5fa858ecdf05a2a05ab4dea247e12b96dccc8b03cf7d3c4135fcafeb37dfad0de5a02aff707dc7374c9f5fb874c9fa6b6ed779e11aa8e14418007ba89a51ac02d9e01193ea77126114b5f121c8a02ebaeb413d760733998ab3c8dbbd6d339330f743e9c858052aad17ad85ce89a69024435455678486a1bd8cd54513c4298187175568ddd1b23b3d87a23f8f1f80dae21a0d2e5325b99f61182659c1d817bd70e15a72d1d663da5e9e88b049d43103e755ffe26aed753c08fdf881651f674045e7c3003a90ac56c7463b20e2ac6f95b8f5c916831a27fa63a49ee857f6860532b440046ba64c6efff6bff483b640d3402e55f5cae14f595f9e41419b6a07e6291e0e3de8324a45fdfd4123e22028f3a410381ddb31ffa4ab67abb253303ea3a659ea8d0c9b5f2ce767cb5974939a40142ef4f65d6df2fbfe4d6c21df4815af1f2241f33aebe14fb2b15b609594a136e9acf76f02515de62ac50ec3f850bbf25d57a6855e6cb3ba62e75cc9751807b9dd86bad851f5e203009f3792d98bda731e2f6c37e33ff5fdaa498b86be83e45656a0903fdbcab72c219823c4e031afcc9ccc573c34161d3d715a363f56088e1bbc5782503fd63460cefd4b22ba702f81bbb2524cba192c9fd56104716bbab6b1dd65c6c9de03c9260728998819396204d4a6b2e4d8d5ef35662e18576128b1c3c2faa083b13b96a29f201f6ec0ca77cef569d4c31e4a99e6b90984329483fbadd46debc1fb12c9fc4bf4981f29ae883d3c079ca189a7c5893e3f384bb09ea4e834b71669703cb5f5ab525a85e4493ac6959d7a4b93c9b600a5da2f3330fde02fb6a7ec6269702f1dce3f9b02b24925d34523f3340568db444a75159e9e7625fde0433166d10b17e4240c2f78fc07af30cb9ba422affaf1ef5acd16d9b8df67e8d491808fc56565a540b4d3abd116f629fcf8472d7e06018980a3cb9ce1358ab83b80a474c4c91f080845ceff55d6ceefaa26e03813586e3f22506ddc7468f1768d61077070a9902783fe97e5a9edeff792a7bfe25c72d7b3093d33b1bcf974b79ecbfcf94fea4aa0262924d34ff7902cf3d6c79e03ff5099618a9158b4add1dcb7c0ee65ae916009b61d308efe3ec7080030916e3daf2b0687619bdebcccd79ac90e78bb6010ac7a6d759eb6c687a2d9025dff9c8acd1fdebb22b0ee94fe964c1bfd1f5e7b5f17097737366c37592055bd21a4c39c23439bd54bbf186dbd8b80b433fa6908b2a4be203ef486c53c6e51861d761bd762f9099ff1c9c1e9c6e51f21c5da5ff6b8278548d024a7f190a5e9b9ad5b00046de9e657d2327313c479ce6b6122884316e4b2bf7666aa2cf593c97c6d65b527ecaf0e05b04a8a3a1f1ab49c21480f0c18338e034ba72b832df12fd9fa400ca3430e72b45e41a592fc648487bd65281483396993db40cebddc33a0c5827a9aabec471b9a75cdfd1dfcfe22431baeb8133dbebf7d068026ce1c81504de921e7eb699c91517bc20343ca2090ca8ec6a808ced1482a39353039d0debd33204771ea2bb8edf157073f9e205811dd1743e641124e92a8fced56023fdb4da79e114fba84350b53fdfd1f4975054b1dcdfb92b82770d8d2c009d1cf4040824b5872e5f225e6577059deb28363996a161ed6e1b02c46da08d93fa1c780235bdf84b0ae86ac1dc6a38801f39685c48336180791d0290c41ec822268802d4872c9266151037206e184c8cd4efc06fe6b0d09177f682c6f0f6f861b6067a02ce650bfa1e6ea09433a6aa2e61ee13d0797551e05ffef5fc09a90ccb6ed2d4654f4628f5807eb5de39bb84538155cf7f22df14530141a061401b6eeae7d2a2119d640d3237ceb49d1b255434180e0cca9a27e4258ff0b1ccc04996ec2c3141a8b5d08f4bf874a36d269bf3e5d8aef7436c26079c8c8374d1cd5de7594409b9db02930223043f3090216873b269ee88ffa8e45628368a449beff248a51a32d5f007035f09f1fa2815d511f115866a645393c05f58e68bbbd9a05bec4caae12827a8bebd75b98bf017813a9d05e08076fcfa7b261a8dc7d422dc6d0fea333145965809ad7ab5e9aa4f99c988d7400f6c6d45d2dc982925546c8d6ce9e828e2b7f312a6293bb3a47304995873f2b49e2d0cd24d9a9c718c00a09f60e9f45e9029a3eec80273a5c13e0806b14b9d028f8ef827734af03560811c97a56e582651f75b78f89902a86bd986b166d57a6d3935ea3bb0f44256a679e9bc777adac11635d8e5bad9e0d3257b945e245492c28c4714d51fa0aad63cc60c8a683bf776e7aba4505322cd3969a021c4db2156239b606ffe3a1698b198c7fa2a3e9262cd8427673a156ecb1c09febb906ae41517e54dc8a350b03b2d75c49508acee9225cfd83da462090403b8148470b1af8414cc50da5a0738749a0e63f45936416497870b9a66fb85fa480370e7acb6720e4bfac5d9c292b4bba40e6ee563ad349bb75bf447c1a251f7e7b5afa487f34d78954adef4c82c47cc3643b6a9e4c11e183ca5e7d981832096b6a3896c4d6cf54360603cc230a0a7949e6a2bf9891dd434d7124d15c99999e3ef7a75de1ee5f685dcdb4f5ecfd41897da7e5c3b0e46fd702d231a806e50a81da72a03267cd555e70b7683fbecd8ce077998af44f39429feceb7536fd63c5c1cc462270351161d492e7a9dec960f006219aaf26e292ec9401ee374b8199604cca68b769742df3f2691e4f6825e9423f3479f06639033826e94ad4a276566a3599052b0ed095f906386bb725a20aaf2904e6bdff7d5aae99ee8575860288e267d2fb6d21ba7e41116d50d0845adbc21da57903399e81ef52d03871fbc3a264ca0bc45156063732e3c4166bddd92860e0a53e2b44cc8a084f0f67af918998a8d006cbbb93038fe6e489d755d9a1b855d92570a1da83410d66f9d693ea098dfb198f00030f500',
  },
  sign_message: {
    message: {
      protocolVersion: 1,
      contractId:
        '759ab9b1be548c00f904be80fbb5d868763bc0e65262f9924b9bc2fa15076c29',
      cetAdaptorSignatures: {
        ecdsaAdaptorSignatures: [
          {
            signature:
              '02232f45237c1ad4387778808facdb427bce78f9114ee997c91be63b38ac02abe803988ca510b0abb1b0852daa4220f5b914b6c5af22dafc14915eb763bc6fc938df52ff1da3f2d52f2bf5df31cfa0512da3f6a35ed4cc5a105aa3beba946c4de88c38b47687cde7a85503941a910e6b12b6aff137669d93af564a22e5b84aa93511ac81b75708294931afb38574b152d4a63093f488172404e78dbd6ce35f4710b0',
          },
          {
            signature:
              '03bbf06aadd1a175dca1836420f6953cfcf2988bea8fda685840f082ed23d04a2402e27160b3c527e3a471b7c4b9c8dfb7d12db060ce77068d8252bde53ac898c4c74027c4ca20229c4bacd56dde3ff811c43fb1c694e20624b67d84e9ce10f7f50a3f9249dd8c6247ba9f7a0034a162645f3958c47d285cc45cd4f956b383d09f83a2a2e883bd9e5ad581cf850fe987ba03fa49d59141c3c0b64547b27592085920',
          },
          {
            signature:
              '024a6351cff3650cf1efe3c5041a1de6fa86ac1acb8d812e0a49990db0985fc36d02d99adb4bc4ddf2e009523fd2ba71a6d41fc3fab22454665a5cc1677016311c2062b62f8eb923afc61658196994072d12b9dd96fb54e1dc3325dd8fab6eae04bc01ee456426054e7fbad93dc13314fefdb9ce8fc5659c1673a4b153e9005879dc53deab0058de6805e152071e771a38cf7c453889d9a25bdafcc6f257abeee099',
          },
          {
            signature:
              '03e37b9a8b9bc7a863c297994ebeeba3b2bcd704159dc7402a40330bc87be30a91032d841849ba0a40ea48c39a549b7235bf4c886dc21eed0e25c00b164514f01d4fa16be6c0d0466edf13a3aeaed71df0e25d133d797612b30bd9829c5915ccc8e28018ae3fcf9854eafc5428fd40a95b11744157e2629806b9f8e381f2ca613144ba0500884ef4f0a903cb9778850300bd41c1f6515dd0824aec476f9b04dd2763',
          },
          {
            signature:
              '03833043b7b72b9e2209864134843117825504b0bb58f8c91f19e0801492b98f0b03f807e2042a652be11783e9f74d1929b4cdf45c812314f5e122d6eeab697bfa9ee69b33557e8dcdd823bed1cadd9339034a37a954367859c71ba521136321e8fbf9f02e65952ebcd6276dcc51f4209005718ef8b3d0ba2b10aee193b874160611bac854fb911e16f866503ad908d4a0813c2f351cd80abab3dc8913dfe4d08042',
          },
          {
            signature:
              '0348ef3e03444eec10d5d0e7a6b7252c650302b83810ce2984335c32cef4b4ef66039b6831cbc2d6be579d3bdb0f254e0ce93b0a2d439d07d7a7e10b2c5c1c56f8cb2cfbfe849413b846e3d731c01c66ed24fdbbb01b8b869a7d4a454d9f65f7711f3bb2a46caa4689b679b053d0b833763f863a365665de77b7034e5a8b91c29df831d357d91a6627fbb05891f7c8cf8df2b6c3632673c4a864efe54db5bba77746',
          },
          {
            signature:
              '02847da48a707c79c1f27786fdbba148e6c0423550edfc22464f9d6b79d9c9c7ca025757c8f743f35b3eb26f87d8049f01e96b95fe924a4685570c871df5d90cb0d94235f208558a61704c41a9422e32586dcb97f94d04b02b1241bfdc27d890604a1e330ad55bdf9d490a8920d1f7af99d45dd858beb326d4790c50761857510117fb45aca86b3d66264e00de7ce068b8d7a284f32f382ae1b237632671b3a30f09',
          },
          {
            signature:
              '02c67f1659c12d3c082c9dc5c36141e2d4078e46ed31dae7e6f6411c7e8f5f0d1f0375384850148dad24a9b2728e4f4b29c755a3d90c27b3962e18fb269ec680b1c130b4240a85baf67169ab518319af9f3aa9dfffd31dae2f4cd3bf8065905f8d31a3555412a001f12e8da1e3c62f9b74bbbcc4270b52c882c5e00eaf51bf116806e237943c30646da3378f4a2f0ce4572285dc18314a74e6ac08489ec00ea25cfb',
          },
          {
            signature:
              '02cf5a50e0f974c95c6b2e1a6361e2ed4b97c9c9ca33a28329bad56ba7209414cb032b2f54a7f816603ab358d2030b6db1fac68950ffa9e34b48f797a5acaa95fe6761d0cd46eb0a96100055aad98f9125ac61ccb1bc9d83653e18f6e0350acb969f18dd83ed5a0b8e8e4a91cf5644082249e0bc36cc70d4a67a8d1b34069268c16f416e40a504d1e8dff94dfba0921f581debfc1838cddf5b5904139b14425f4d81',
          },
          {
            signature:
              '022d6289f40e166e4c8f1ae08791bc89510d403b540c0b0b176e4a17eeee2c464c0394ffdc557305902d306e4416c5795950a3dc8e8d94c2e1acce389f3fa606e5cb172b4758051a86bd35cb13a8263de4e55c9426affcb026bfb5946d79fbe31b74435a5d92262822894fb65e5af4cb57f9b2abc509b363c6f69684bfea4a5340a11bd78e08a3e5c3c6a2ee39d304f381172e47820668b3aa55b87ddf4c0d06c997',
          },
          {
            signature:
              '037fbdf92b68a03f4a840c9f147df7da750adc1bc60cad63d85073a343474e18a00306c912d62a94ab2512cf9217035aa625b2b88976935dc08b94a2c1427a25d2c105acc95df81e2f3f78f4fae259a4fbaffd9d70c6281227233902157828f926fd1ddcb741342d2c0419a6d0f0d21b28c5364c286fb4289a9c67305d4889985601ac85635d4f057cc7993f931a7dbde24731666302a4e6991fe3a85e2becc60a96',
          },
          {
            signature:
              '030046bdf7aa7fe64c58614a18c366557a3f6e4ea5ed3b25f5144f1664e95f641203497aaad97dfcdc4d8d805fdcd6117f43e57f0cf3d20f32e5ce3874befab25206ae797af24702d134cd0d77a4775dd22131c1b7ae0ee5683f11ab7e0e8124327e1cc466a8f4065401f5239aadd4f8c073079c02b3402e2d76c798557deb4c60a8f93388a70f4ce9a56cc3a682f4efb62b6346ac00502cf58966d3c49050688c1b',
          },
          {
            signature:
              '02d75890621006bc2dff47fb9c1e879fa989d8d295caecfe6c3cc65de822c7b10902fbc55c49fe80fac44da248afced8d3d1fa0dcae278ec48971187a79dd36e6ecb032b8463c161b999f70f28ff3250ba2ae1bade2e295231e6f42d8548f4a7cdfffc8b5179749d540c91e5cdb06ae79876041e0b7cb439c9d7b2414ac16287f8b47cf77e15e1ae8dd146c874653abe98302ae399d2df934d6d02d16a5974b4ce1b',
          },
          {
            signature:
              '021a6337382a04a9e6e85b875e281baf300d00741e574a1fd985156dd6ccb464060301dfe5ed67e91095481d1ec90d48bd8642e7f69650e9f68d6ada2867676c8406d2fdf9be855a8506191987762854eb60ba5308d5009c1502a2d989e7071e38a5bfa258570d5813e4ac345751e69f4536951f409e099b306ac3d5def642a03633e17c093d5d16d291aa82dfbd83151d6e1efe3ac8ef50f15360ab890ac2016f4d',
          },
        ],
      },
      refundSignature:
        '30440220491f5b5e6b56045ed39a1292acf5d192aac322a43b0e80609f3c6a679461c38a022077b47bdd4feef82eec58c2d7b00423aa0b654ce1ccc9206e77d2050288e48be0',
      fundingSignatures: {
        fundingSignatures: [
          {
            witnessElements: [
              {
                witness:
                  '3043021f6a395463c93d03c7bc7317629c7236045b5fcdaf57dfb21d6656e94eb9f8ec02200c73e36a48dc4cf8dedfcc515e3f4c418632cb3fcef7f8cce5dea351cc44260901',
              },
              {
                witness:
                  '0393ff1a655e19b0227705f13afef38fa2180c45f3b1822c8637c22602d68f9493',
              },
            ],
          },
        ],
      },
    },
    serialized:
      'a71e00000001759ab9b1be548c00f904be80fbb5d868763bc0e65262f9924b9bc2fa15076c290e02232f45237c1ad4387778808facdb427bce78f9114ee997c91be63b38ac02abe803988ca510b0abb1b0852daa4220f5b914b6c5af22dafc14915eb763bc6fc938df52ff1da3f2d52f2bf5df31cfa0512da3f6a35ed4cc5a105aa3beba946c4de88c38b47687cde7a85503941a910e6b12b6aff137669d93af564a22e5b84aa93511ac81b75708294931afb38574b152d4a63093f488172404e78dbd6ce35f4710b003bbf06aadd1a175dca1836420f6953cfcf2988bea8fda685840f082ed23d04a2402e27160b3c527e3a471b7c4b9c8dfb7d12db060ce77068d8252bde53ac898c4c74027c4ca20229c4bacd56dde3ff811c43fb1c694e20624b67d84e9ce10f7f50a3f9249dd8c6247ba9f7a0034a162645f3958c47d285cc45cd4f956b383d09f83a2a2e883bd9e5ad581cf850fe987ba03fa49d59141c3c0b64547b27592085920024a6351cff3650cf1efe3c5041a1de6fa86ac1acb8d812e0a49990db0985fc36d02d99adb4bc4ddf2e009523fd2ba71a6d41fc3fab22454665a5cc1677016311c2062b62f8eb923afc61658196994072d12b9dd96fb54e1dc3325dd8fab6eae04bc01ee456426054e7fbad93dc13314fefdb9ce8fc5659c1673a4b153e9005879dc53deab0058de6805e152071e771a38cf7c453889d9a25bdafcc6f257abeee09903e37b9a8b9bc7a863c297994ebeeba3b2bcd704159dc7402a40330bc87be30a91032d841849ba0a40ea48c39a549b7235bf4c886dc21eed0e25c00b164514f01d4fa16be6c0d0466edf13a3aeaed71df0e25d133d797612b30bd9829c5915ccc8e28018ae3fcf9854eafc5428fd40a95b11744157e2629806b9f8e381f2ca613144ba0500884ef4f0a903cb9778850300bd41c1f6515dd0824aec476f9b04dd276303833043b7b72b9e2209864134843117825504b0bb58f8c91f19e0801492b98f0b03f807e2042a652be11783e9f74d1929b4cdf45c812314f5e122d6eeab697bfa9ee69b33557e8dcdd823bed1cadd9339034a37a954367859c71ba521136321e8fbf9f02e65952ebcd6276dcc51f4209005718ef8b3d0ba2b10aee193b874160611bac854fb911e16f866503ad908d4a0813c2f351cd80abab3dc8913dfe4d080420348ef3e03444eec10d5d0e7a6b7252c650302b83810ce2984335c32cef4b4ef66039b6831cbc2d6be579d3bdb0f254e0ce93b0a2d439d07d7a7e10b2c5c1c56f8cb2cfbfe849413b846e3d731c01c66ed24fdbbb01b8b869a7d4a454d9f65f7711f3bb2a46caa4689b679b053d0b833763f863a365665de77b7034e5a8b91c29df831d357d91a6627fbb05891f7c8cf8df2b6c3632673c4a864efe54db5bba7774602847da48a707c79c1f27786fdbba148e6c0423550edfc22464f9d6b79d9c9c7ca025757c8f743f35b3eb26f87d8049f01e96b95fe924a4685570c871df5d90cb0d94235f208558a61704c41a9422e32586dcb97f94d04b02b1241bfdc27d890604a1e330ad55bdf9d490a8920d1f7af99d45dd858beb326d4790c50761857510117fb45aca86b3d66264e00de7ce068b8d7a284f32f382ae1b237632671b3a30f0902c67f1659c12d3c082c9dc5c36141e2d4078e46ed31dae7e6f6411c7e8f5f0d1f0375384850148dad24a9b2728e4f4b29c755a3d90c27b3962e18fb269ec680b1c130b4240a85baf67169ab518319af9f3aa9dfffd31dae2f4cd3bf8065905f8d31a3555412a001f12e8da1e3c62f9b74bbbcc4270b52c882c5e00eaf51bf116806e237943c30646da3378f4a2f0ce4572285dc18314a74e6ac08489ec00ea25cfb02cf5a50e0f974c95c6b2e1a6361e2ed4b97c9c9ca33a28329bad56ba7209414cb032b2f54a7f816603ab358d2030b6db1fac68950ffa9e34b48f797a5acaa95fe6761d0cd46eb0a96100055aad98f9125ac61ccb1bc9d83653e18f6e0350acb969f18dd83ed5a0b8e8e4a91cf5644082249e0bc36cc70d4a67a8d1b34069268c16f416e40a504d1e8dff94dfba0921f581debfc1838cddf5b5904139b14425f4d81022d6289f40e166e4c8f1ae08791bc89510d403b540c0b0b176e4a17eeee2c464c0394ffdc557305902d306e4416c5795950a3dc8e8d94c2e1acce389f3fa606e5cb172b4758051a86bd35cb13a8263de4e55c9426affcb026bfb5946d79fbe31b74435a5d92262822894fb65e5af4cb57f9b2abc509b363c6f69684bfea4a5340a11bd78e08a3e5c3c6a2ee39d304f381172e47820668b3aa55b87ddf4c0d06c997037fbdf92b68a03f4a840c9f147df7da750adc1bc60cad63d85073a343474e18a00306c912d62a94ab2512cf9217035aa625b2b88976935dc08b94a2c1427a25d2c105acc95df81e2f3f78f4fae259a4fbaffd9d70c6281227233902157828f926fd1ddcb741342d2c0419a6d0f0d21b28c5364c286fb4289a9c67305d4889985601ac85635d4f057cc7993f931a7dbde24731666302a4e6991fe3a85e2becc60a96030046bdf7aa7fe64c58614a18c366557a3f6e4ea5ed3b25f5144f1664e95f641203497aaad97dfcdc4d8d805fdcd6117f43e57f0cf3d20f32e5ce3874befab25206ae797af24702d134cd0d77a4775dd22131c1b7ae0ee5683f11ab7e0e8124327e1cc466a8f4065401f5239aadd4f8c073079c02b3402e2d76c798557deb4c60a8f93388a70f4ce9a56cc3a682f4efb62b6346ac00502cf58966d3c49050688c1b02d75890621006bc2dff47fb9c1e879fa989d8d295caecfe6c3cc65de822c7b10902fbc55c49fe80fac44da248afced8d3d1fa0dcae278ec48971187a79dd36e6ecb032b8463c161b999f70f28ff3250ba2ae1bade2e295231e6f42d8548f4a7cdfffc8b5179749d540c91e5cdb06ae79876041e0b7cb439c9d7b2414ac16287f8b47cf77e15e1ae8dd146c874653abe98302ae399d2df934d6d02d16a5974b4ce1b021a6337382a04a9e6e85b875e281baf300d00741e574a1fd985156dd6ccb464060301dfe5ed67e91095481d1ec90d48bd8642e7f69650e9f68d6ada2867676c8406d2fdf9be855a8506191987762854eb60ba5308d5009c1502a2d989e7071e38a5bfa258570d5813e4ac345751e69f4536951f409e099b306ac3d5def642a03633e17c093d5d16d291aa82dfbd83151d6e1efe3ac8ef50f15360ab890ac2016f4d491f5b5e6b56045ed39a1292acf5d192aac322a43b0e80609f3c6a679461c38a77b47bdd4feef82eec58c2d7b00423aa0b654ce1ccc9206e77d2050288e48be00102463043021f6a395463c93d03c7bc7317629c7236045b5fcdaf57dfb21d6656e94eb9f8ec02200c73e36a48dc4cf8dedfcc515e3f4c418632cb3fcef7f8cce5dea351cc44260901210393ff1a655e19b0227705f13afef38fa2180c45f3b1822c8637c22602d68f9493',
  },
};

// three_of_five_oracle_numerical_with_diff_test
const testVector4 = {
  offer_message: {
    message: {
      protocolVersion: 1,
      contractFlags: 0,
      chainHash:
        '06226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f',
      temporaryContractId:
        '148566ed81e8b1a30e318994a1e108f32b50fe1525e93d55557641f527fd248d',
      contractInfo: {
        singleContractInfo: {
          totalCollateral: 200000000,
          contractInfo: {
            contractDescriptor: {
              numericOutcomeContractDescriptor: {
                numDigits: 10,
                payoutFunction: {
                  payoutFunctionPieces: [
                    {
                      endPoint: {
                        eventOutcome: 0,
                        outcomePayout: 0,
                        extraPrecision: 0,
                      },
                      payoutCurvePiece: {
                        polynomialPayoutCurvePiece: {
                          payoutPoints: [
                            {
                              eventOutcome: 3,
                              outcomePayout: 100000000,
                              extraPrecision: 0,
                            },
                          ],
                        },
                      },
                    },
                    {
                      endPoint: {
                        eventOutcome: 5,
                        outcomePayout: 200000000,
                        extraPrecision: 0,
                      },
                      payoutCurvePiece: {
                        polynomialPayoutCurvePiece: {
                          payoutPoints: [],
                        },
                      },
                    },
                  ],
                  lastEndpoint: {
                    eventOutcome: 1023,
                    outcomePayout: 200000000,
                    extraPrecision: 0,
                  },
                },
                roundingIntervals: {
                  intervals: [
                    {
                      beginInterval: 0,
                      roundingMod: 1,
                    },
                  ],
                },
              },
            },
            oracleInfo: {
              multi: {
                threshold: 3,
                oracleAnnouncements: [
                  {
                    announcementSignature:
                      '3ce4b9ee522955d2e29d676296438bcc94b851df5c5b5d681a140d7ed0f1db2830451fb9b990641163b8a67a2c5095d226af27fd31246c29b1948e4767713623',
                    oraclePublicKey:
                      '397e1d4f73e3a666cb600f0ba7dd6e9985a8c8bc71e194cda40a73c267abc554',
                    oracleEvent: {
                      oracleNonces: [
                        '23a6e82b514250f5aed85a277ccedd4fb252a9e1df0c7a345a396bd50022be36',
                        '89ac1e209b10e171f244964f7fe65e56c305de8de524551f45d2cd70dd1948fe',
                        'e20108ad2396915a7b27e8a3ad3aec2bc9c45463134b12d8fefd0f2eed928d92',
                        'b4ac85d28d89d1a3b3ec8b0d23e5431ca75426a624475e93c078e2da0c0be163',
                        '46d191ab5330119f8082bbb7ff8cdf07436535a492393ae301942ff0cf965d82',
                        'ed617a694ee365158e285713dd7fcb6389bef2375643c687ffaa7a62a38e3656',
                        '16c18778a4bd446d15f2f6d1d510151bf1b8ee2982c44ed5214c9ce36b97d207',
                        'dfd50601c30b6a501a49eeef14c1bb4b83cf80a92fb2a7d0e473f3d39c57dadf',
                        '6ba3dcb3a5b91e50822b4dc2eeac05b592370630898e87fb3139b8ac4e734010',
                        '17718ce0c563b9db5f480f79a6654e8891a8f153ad8b47608f32b075182a95e4',
                      ],
                      eventMaturityEpoch: 1623133104,
                      eventDescriptor: {
                        digitDecompositionEvent: {
                          base: 2,
                          isSigned: false,
                          unit: 'sats/sec',
                          precision: 0,
                          nbDigits: 10,
                        },
                      },
                      eventId: 'Test',
                    },
                  },
                  {
                    announcementSignature:
                      '81d06891327fdf2170ecfad350bb34d0a531f7078c3a1ee891e1a79646a0a1707145db61e60eaaeb5c3f749f8c2e6b4305cb46c8aaebb800a3015adaec9ffe42',
                    oraclePublicKey:
                      '68659d38b38d96faf551b574a4464a76b8a6a20d12a7a06229ad3a5c87ab0fd0',
                    oracleEvent: {
                      oracleNonces: [
                        '6a81737087f35e5fedcb4d4854a9026252d92f0794c972ebde7b26ec234f3b51',
                        'a24ca03078336cf84e75dd19e741956d63ebf7daaf0c0138fb48b1d5e57e6872',
                        'e5c8a8d5b675377ef728580dca03b5cf46eeed76a045d597ccd23d969279c654',
                        '96a8942c0a4a4fed7ae39800775a8533a646288cce4106751c8e2734ca18cf81',
                        '14613a6b3281e9a2cedbcce8ce759652df212061d06d5ce05ebaae2bb532cc6c',
                        'a6024ae024436bd0a29f470255b0de2ac0af78ebdf8a9af4f9b90ed76fb2d292',
                        'daa47681d6cc68d88eb60b0af440fa0dd2e76dfdd1ca570dfb896467e9223978',
                        '28e321cb6153b59542b0e819de622d33bfd27a167bd96f4535d36df2ce8c611d',
                        '0524dba45112cc5346e30aa0be1ef942713f0e7682191bee0bf20c2bbe97255d',
                        '9f666b8766f17ec95fcb763fd6c17f20e4be559a13d4405c40e4a7de0d5630e2',
                      ],
                      eventMaturityEpoch: 1623133104,
                      eventDescriptor: {
                        digitDecompositionEvent: {
                          base: 2,
                          isSigned: false,
                          unit: 'sats/sec',
                          precision: 0,
                          nbDigits: 10,
                        },
                      },
                      eventId: 'Test',
                    },
                  },
                  {
                    announcementSignature:
                      '69ac5c94643cd75a93ee77aec01b3f2f0939e88b7f8e22d80a18396f0f2a15a0094d5352541e45476651259fa44a8657dbae19f302a7e4bc2047b5d06acd3bd3',
                    oraclePublicKey:
                      'deafc9f23d24a5249ccd16147f9c794cd117c88553bfe5034eb23fbd0078bcbb',
                    oracleEvent: {
                      oracleNonces: [
                        '604146200c6b04b5eb49ef630c55f9ccbc40135d9a621507d1fe49810c424e90',
                        '6b933ad9dba682d4cb31574c7b846734abca44c146613643a136eb103e51d17c',
                        'd25aa537346818c4cc61278e2b4d1d690b17788b2e67762fd2bfbdd601f01793',
                        'bc0b8e6ada776511c39a36f5bc14a4ad78fdb87ee615fbd5aaa571d3104c3cb8',
                        'cd8a23c43da2cfcdd20b8407ec7d8cc8d14003d4efc0f96b0f1799ef61afd84a',
                        'e3706817b51d048caeb15111f7265b7af68d859735bf7fe7f5ab9d6882b10374',
                        'c8adeab27551a280fb6f249ed88d4ba183516bb0bb1f23755867880891ec57b6',
                        '465e8841131dd9a95720c05fa99aa6b5726823b34bd8dad7c83e9006c059d998',
                        '33173b0713bc20d4ef207a29088242cdf5b211d3b7abacf9299f117841bf4186',
                        '0df2e1c0e8bf7adf815a55f6ff1e80b04ce06701045c6872ba92d663cec74e00',
                      ],
                      eventMaturityEpoch: 1623133104,
                      eventDescriptor: {
                        digitDecompositionEvent: {
                          base: 2,
                          isSigned: false,
                          unit: 'sats/sec',
                          precision: 0,
                          nbDigits: 10,
                        },
                      },
                      eventId: 'Test',
                    },
                  },
                  {
                    announcementSignature:
                      '6503621f1debda991b01b5d7b143e4bf52f00e87e8435b3099aec4a970f20f1c382a852f54fbaae43da4b9fc9d24d299e0bfc91eeca6bf5968f97527f362b2ad',
                    oraclePublicKey:
                      'df29d56e84b201f198edc3f35575fc5ca23995d441d4166395ed42089f171e90',
                    oracleEvent: {
                      oracleNonces: [
                        '4bd3b2e8f85b8bb7b8a292d1d1932c838f033b9088d63bf40ec4228f6284fdac',
                        '3a06eb7efd4d848f5f0b33eaa8f5d1d2a282e24d6b7a493d4f56cc58ecad1df3',
                        '02050a47ad0fb4687dcccd82b28a30c3ffc8786acf5e210b53ad748d500d84fa',
                        'b769e602ab3d49f5b1ebd0926748a8566b01e3106f371f2015cbb1b9e2cc2c6d',
                        '653af5d80c8e398a43bce6ef42983fe531faacfac638975a8b225d34f4c4a6cc',
                        'e2cbca4c7f15554902a9229d5c6e3bab1b5433161131a5d6730105148b8a59bb',
                        '8da3237379b56cef484bbb55c155f7e89b90b9146ebd72295419d2ff741a35a4',
                        '176ddefac3a0e2391989ee30e0a82fbde7013dd176f06c2527c73cd835595c77',
                        'c0d2fbc769776afa7e2e82e0fec8edfaab1f6921e61a8b6eb55605a1dfe84aa1',
                        'c784584bf2126aac6cf3c1bd4418776872c83d5dee55f727c399328502996ffb',
                      ],
                      eventMaturityEpoch: 1623133104,
                      eventDescriptor: {
                        digitDecompositionEvent: {
                          base: 2,
                          isSigned: false,
                          unit: 'sats/sec',
                          precision: 0,
                          nbDigits: 10,
                        },
                      },
                      eventId: 'Test',
                    },
                  },
                  {
                    announcementSignature:
                      '54ffc8a1d480ca3c690e16961c398fe7cd4c00f47dc06c8dd80fc8e4213703292a1fde2e56b3de090395a035732393d25b8643408660d5b17c05696fd2d32514',
                    oraclePublicKey:
                      'bbf0610d8af50a716c17ef0d75c74cad7a30f7a74b78dede8e57523b6b09aa1d',
                    oracleEvent: {
                      oracleNonces: [
                        '1c83de34cc821210b0d70593ab6426dbe332a19f42371287b20ff6982ec08b3e',
                        'af0bf1d4a79ad8a385b01420e203a1afe115e22f8d83af622234abbd8bb36bcd',
                        '569af350f588c5c42fd4943553f79d536d054fe3e39950accb67468e68ee5833',
                        'dc8a4fb3468f76481a238fc4f7587972aa2d64e402ea36a7e37fde5efa2611e5',
                        '87c5070980271a9c6dfecd989886237f9e9182a4a7da4d5add26d2a9f66b084e',
                        '92dbe9f6afcb72c0308574dd4b4298bd858073278d797dc627e3e2a7a3e2f30b',
                        '8764a741c533f370ae6516e3c8f0f72a4762f2eed697b4a20776e83210bedf75',
                        '41203183b64aaa481c02bb612886227156806764cb5110531e329ab3f4bc3d17',
                        'd2d61abadb4a93ed496e28345a359d7afff3001375c02d45d08c5fdd63ce54af',
                        'd75e3a5ae3e8d9418b30669c49ddfea4ce7b2bc50ddd80f56ff655c31b482926',
                      ],
                      eventMaturityEpoch: 1623133104,
                      eventDescriptor: {
                        digitDecompositionEvent: {
                          base: 2,
                          isSigned: false,
                          unit: 'sats/sec',
                          precision: 0,
                          nbDigits: 10,
                        },
                      },
                      eventId: 'Test',
                    },
                  },
                ],
                oracleParams: {
                  maxErrorExp: 2,
                  minFailExp: 1,
                  maximizeCoverage: false,
                },
              },
            },
          },
        },
      },
      fundingPubkey:
        '0240d196401f79d28ebb06999177882c1a127f5e12d893c06d4f08bf0be145c440',
      payoutSpk: '0014346a9823bae5833bb576c7ee5a7a5e41128d734e',
      payoutSerialId: 891122273356470082,
      offerCollateral: 100000000,
      fundingInputs: [
        {
          inputSerialId: 6184988801133107175,
          prevTx:
            '020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a01000000160014eda281b5ccf8374dce2c3ebc030e0a1ea42d39f00000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000',
          prevTxVout: 0,
          sequence: 4294967295,
          maxWitnessLen: 107,
          redeemScript: '',
        },
      ],
      changeSpk: '00143905d9b8e82b7f182b4a114b12a1a9a63345b198',
      changeSerialId: 11232368518532189448,
      fundOutputSerialId: 108940407758488876,
      feeRatePerVb: 2,
      cetLocktime: 1623133104,
      refundLocktime: 1623737904,
    },
    serialized:
      'a71a000000010006226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f148566ed81e8b1a30e318994a1e108f32b50fe1525e93d55557641f527fd248d00000000000bebc20001000a02000000000000000000000000000000000000000100000000000000030000000005f5e10000000000000000000005000000000bebc2000000000000000000000003ff000000000bebc2000000010000000000000000000000000000000101000305fdd824fd01c73ce4b9ee522955d2e29d676296438bcc94b851df5c5b5d681a140d7ed0f1db2830451fb9b990641163b8a67a2c5095d226af27fd31246c29b1948e4767713623397e1d4f73e3a666cb600f0ba7dd6e9985a8c8bc71e194cda40a73c267abc554fdd822fd0161000a23a6e82b514250f5aed85a277ccedd4fb252a9e1df0c7a345a396bd50022be3689ac1e209b10e171f244964f7fe65e56c305de8de524551f45d2cd70dd1948fee20108ad2396915a7b27e8a3ad3aec2bc9c45463134b12d8fefd0f2eed928d92b4ac85d28d89d1a3b3ec8b0d23e5431ca75426a624475e93c078e2da0c0be16346d191ab5330119f8082bbb7ff8cdf07436535a492393ae301942ff0cf965d82ed617a694ee365158e285713dd7fcb6389bef2375643c687ffaa7a62a38e365616c18778a4bd446d15f2f6d1d510151bf1b8ee2982c44ed5214c9ce36b97d207dfd50601c30b6a501a49eeef14c1bb4b83cf80a92fb2a7d0e473f3d39c57dadf6ba3dcb3a5b91e50822b4dc2eeac05b592370630898e87fb3139b8ac4e73401017718ce0c563b9db5f480f79a6654e8891a8f153ad8b47608f32b075182a95e460bf0bb0fdd80a1200020008736174732f73656300000000000a0454657374fdd824fd01c781d06891327fdf2170ecfad350bb34d0a531f7078c3a1ee891e1a79646a0a1707145db61e60eaaeb5c3f749f8c2e6b4305cb46c8aaebb800a3015adaec9ffe4268659d38b38d96faf551b574a4464a76b8a6a20d12a7a06229ad3a5c87ab0fd0fdd822fd0161000a6a81737087f35e5fedcb4d4854a9026252d92f0794c972ebde7b26ec234f3b51a24ca03078336cf84e75dd19e741956d63ebf7daaf0c0138fb48b1d5e57e6872e5c8a8d5b675377ef728580dca03b5cf46eeed76a045d597ccd23d969279c65496a8942c0a4a4fed7ae39800775a8533a646288cce4106751c8e2734ca18cf8114613a6b3281e9a2cedbcce8ce759652df212061d06d5ce05ebaae2bb532cc6ca6024ae024436bd0a29f470255b0de2ac0af78ebdf8a9af4f9b90ed76fb2d292daa47681d6cc68d88eb60b0af440fa0dd2e76dfdd1ca570dfb896467e922397828e321cb6153b59542b0e819de622d33bfd27a167bd96f4535d36df2ce8c611d0524dba45112cc5346e30aa0be1ef942713f0e7682191bee0bf20c2bbe97255d9f666b8766f17ec95fcb763fd6c17f20e4be559a13d4405c40e4a7de0d5630e260bf0bb0fdd80a1200020008736174732f73656300000000000a0454657374fdd824fd01c769ac5c94643cd75a93ee77aec01b3f2f0939e88b7f8e22d80a18396f0f2a15a0094d5352541e45476651259fa44a8657dbae19f302a7e4bc2047b5d06acd3bd3deafc9f23d24a5249ccd16147f9c794cd117c88553bfe5034eb23fbd0078bcbbfdd822fd0161000a604146200c6b04b5eb49ef630c55f9ccbc40135d9a621507d1fe49810c424e906b933ad9dba682d4cb31574c7b846734abca44c146613643a136eb103e51d17cd25aa537346818c4cc61278e2b4d1d690b17788b2e67762fd2bfbdd601f01793bc0b8e6ada776511c39a36f5bc14a4ad78fdb87ee615fbd5aaa571d3104c3cb8cd8a23c43da2cfcdd20b8407ec7d8cc8d14003d4efc0f96b0f1799ef61afd84ae3706817b51d048caeb15111f7265b7af68d859735bf7fe7f5ab9d6882b10374c8adeab27551a280fb6f249ed88d4ba183516bb0bb1f23755867880891ec57b6465e8841131dd9a95720c05fa99aa6b5726823b34bd8dad7c83e9006c059d99833173b0713bc20d4ef207a29088242cdf5b211d3b7abacf9299f117841bf41860df2e1c0e8bf7adf815a55f6ff1e80b04ce06701045c6872ba92d663cec74e0060bf0bb0fdd80a1200020008736174732f73656300000000000a0454657374fdd824fd01c76503621f1debda991b01b5d7b143e4bf52f00e87e8435b3099aec4a970f20f1c382a852f54fbaae43da4b9fc9d24d299e0bfc91eeca6bf5968f97527f362b2addf29d56e84b201f198edc3f35575fc5ca23995d441d4166395ed42089f171e90fdd822fd0161000a4bd3b2e8f85b8bb7b8a292d1d1932c838f033b9088d63bf40ec4228f6284fdac3a06eb7efd4d848f5f0b33eaa8f5d1d2a282e24d6b7a493d4f56cc58ecad1df302050a47ad0fb4687dcccd82b28a30c3ffc8786acf5e210b53ad748d500d84fab769e602ab3d49f5b1ebd0926748a8566b01e3106f371f2015cbb1b9e2cc2c6d653af5d80c8e398a43bce6ef42983fe531faacfac638975a8b225d34f4c4a6cce2cbca4c7f15554902a9229d5c6e3bab1b5433161131a5d6730105148b8a59bb8da3237379b56cef484bbb55c155f7e89b90b9146ebd72295419d2ff741a35a4176ddefac3a0e2391989ee30e0a82fbde7013dd176f06c2527c73cd835595c77c0d2fbc769776afa7e2e82e0fec8edfaab1f6921e61a8b6eb55605a1dfe84aa1c784584bf2126aac6cf3c1bd4418776872c83d5dee55f727c399328502996ffb60bf0bb0fdd80a1200020008736174732f73656300000000000a0454657374fdd824fd01c754ffc8a1d480ca3c690e16961c398fe7cd4c00f47dc06c8dd80fc8e4213703292a1fde2e56b3de090395a035732393d25b8643408660d5b17c05696fd2d32514bbf0610d8af50a716c17ef0d75c74cad7a30f7a74b78dede8e57523b6b09aa1dfdd822fd0161000a1c83de34cc821210b0d70593ab6426dbe332a19f42371287b20ff6982ec08b3eaf0bf1d4a79ad8a385b01420e203a1afe115e22f8d83af622234abbd8bb36bcd569af350f588c5c42fd4943553f79d536d054fe3e39950accb67468e68ee5833dc8a4fb3468f76481a238fc4f7587972aa2d64e402ea36a7e37fde5efa2611e587c5070980271a9c6dfecd989886237f9e9182a4a7da4d5add26d2a9f66b084e92dbe9f6afcb72c0308574dd4b4298bd858073278d797dc627e3e2a7a3e2f30b8764a741c533f370ae6516e3c8f0f72a4762f2eed697b4a20776e83210bedf7541203183b64aaa481c02bb612886227156806764cb5110531e329ab3f4bc3d17d2d61abadb4a93ed496e28345a359d7afff3001375c02d45d08c5fdd63ce54afd75e3a5ae3e8d9418b30669c49ddfea4ce7b2bc50ddd80f56ff655c31b48292660bf0bb0fdd80a1200020008736174732f73656300000000000a04546573740100020001000240d196401f79d28ebb06999177882c1a127f5e12d893c06d4f08bf0be145c44000160014346a9823bae5833bb576c7ee5a7a5e41128d734e0c5de6fc7ad9d7420000000005f5e1000155d57e8b8f4ed7e7a8020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff0200f2052a01000000160014eda281b5ccf8374dce2c3ebc030e0a1ea42d39f00000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf9012000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff006b0000001600143905d9b8e82b7f182b4a114b12a1a9a63345b1989be163a7ed644d08018308b94221852c000000000000000260bf0bb060c84630',
  },
};

describe.only('DlcOffer', () => {
  it('should deserialize', () => {
    const dlcOffer = DlcOfferV0.deserialize(
      Buffer.from(testVector.offer_message.serialized, 'hex'),
    );
    console.log('dlcOffer', dlcOffer);
    console.log('dlcOffer.serialized', dlcOffer.serialize().toString('hex'));
    console.log('dlcOffer.JSON', JSON.stringify(dlcOffer.toJSON()));
    const serializedDlcOffer = dlcOffer.serialize();
    expect(serializedDlcOffer.toString('hex')).to.equal(
      testVector.offer_message.serialized,
    );
  });

  it('should deserialize 2', () => {
    const dlcOffer = DlcOfferV0.deserialize(
      Buffer.from(testVector2.offer_message.serialized, 'hex'),
    );
    console.log('dlcOffer', dlcOffer);
    console.log('dlcOffer.serialized', dlcOffer.serialize().toString('hex'));
    console.log('dlcOffer.JSON', JSON.stringify(dlcOffer.toJSON()));
    const serializedDlcOffer = dlcOffer.serialize();
    expect(serializedDlcOffer.toString('hex')).to.equal(
      testVector2.offer_message.serialized,
    );
  });

  it('should deserialize 3', () => {
    const dlcOffer = DlcOfferV0.deserialize(
      Buffer.from(testVector3.offer_message.serialized, 'hex'),
    );
    console.log('dlcOffer', dlcOffer);
    console.log('dlcOffer.serialized', dlcOffer.serialize().toString('hex'));
    console.log('dlcOffer.JSON', JSON.stringify(dlcOffer.toJSON()));
    const serializedDlcOffer = dlcOffer.serialize();
    expect(serializedDlcOffer.toString('hex')).to.equal(
      testVector3.offer_message.serialized,
    );
  });

  it('should deserialize 4', () => {
    const dlcOffer = DlcOfferV0.deserialize(
      Buffer.from(testVector4.offer_message.serialized, 'hex'),
    );
    console.log('dlcOffer', dlcOffer);
    console.log('dlcOffer.serialized', dlcOffer.serialize().toString('hex'));
    console.log('dlcOffer.JSON', JSON.stringify(dlcOffer.toJSON()));
    const serializedDlcOffer = dlcOffer.serialize();
    expect(serializedDlcOffer.toString('hex')).to.equal(
      testVector4.offer_message.serialized,
    );
  });
});
